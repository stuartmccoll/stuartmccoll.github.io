<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Stuart McColl "><meta name=description content="Using the shutdown command Setting a single, non-repeatable shutdown timer can be done using the shutdown command, which can be run in the Command Prompt or PowerShell. Let&amp;rsquo;s use PowerShell as an example.
 Search for &amp;lsquo;PowerShell&amp;rsquo; in the start menu and open the app that is returned. Run the command shutdown -s -t TimeInSeconds where TimeInSeconds is replaced with the number of seconds after which you want the Windows 10 PC to shutdown."><meta name=keywords content="homepage,blog,development,programming"><meta name=robots content="noodp"><link rel=canonical href=https://stuartmccoll.github.io/posts/2020-10-14-automate-windows-10-shutdown/><title>Automate the shutdown of a Windows 10 PC :: Stuart McColl</title><link rel=stylesheet href=/main.min.15c204e66791e2f70ca06e7872b0ed743b4d2392b3c6dc31ba8dbd9f3d4618d2.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><meta name=theme-color content="#252627"><meta itemprop=name content="Automate the shutdown of a Windows 10 PC"><meta itemprop=description content="Using the shutdown command Setting a single, non-repeatable shutdown timer can be done using the shutdown command, which can be run in the Command Prompt or PowerShell. Let&rsquo;s use PowerShell as an example.
 Search for &lsquo;PowerShell&rsquo; in the start menu and open the app that is returned. Run the command shutdown -s -t TimeInSeconds where TimeInSeconds is replaced with the number of seconds after which you want the Windows 10 PC to shutdown."><meta itemprop=datePublished content="2020-10-14T10:00:00+01:00"><meta itemprop=dateModified content="2020-10-14T10:00:00+01:00"><meta itemprop=wordCount content="433"><meta itemprop=image content="https://stuartmccoll.github.io/img/microsoft-windows-logo.png"><meta itemprop=keywords content="microsoft,windows,windows 10,automation,PowerShell,"><meta property="article:published_time" content="2020-10-14 10:00:00 +0100 +0100"><script type=text/javascript>!function(b,d,a){var e=b.location,o="script",n="instrumentationKey",g="ingestionendpoint",k="disableExceptionTracking",i="ai.device.",j="toLowerCase",h="crossOrigin",l="POST",m="appInsightsSDK",f=a.name||"appInsights",c;(a.name||b[m])&&(b[m]=f),c=b[f]||function(f){var z=!1,q=!1,c={initialize:!0,queue:[],sv:"5",version:2,config:f},r,s,m,x,y,B,p,A;function w(b,f){var a={},d="Browser";return a[i+"id"]=d[j](),a[i+"type"]=d,a["ai.operation.name"]=e&&e.pathname||"_unknown_",a["ai.internal.sdkVersion"]="javascript:snippet_"+(c.sv||c.version),{time:function(){var a=new Date;function b(b){var a=""+b;return 1===a.length&&(a="0"+a),a}return a.getUTCFullYear()+"-"+b(1+a.getUTCMonth())+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+((a.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:b,name:"Microsoft.ApplicationInsights."+b.replace(/-/g,"")+"."+f,sampleRate:100,tags:a,data:{baseData:{ver:2}}}}if(r=f.url||a.src,r){function u(x){var h,i,t,u,v,s,o,p,k,d,m;z=!0,c.queue=[],q||(q=!0,h=r,o=function(){var a={},d=f.connectionString,e,b,c,h,i;if(d)for(e=d.split(";"),b=0;b<e.length;b++)c=e[b].split("="),2===c.length&&(a[c[0][j]()]=c[1]);return a[g]||(h=a.endpointsuffix,i=h?a.location:null,a[g]="https://"+(i?i+".":"")+"dc."+(h||"services.visualstudio.com")),a}(),p=o[n]||f[n]||"",k=o[g],d=k?k+"/v2/track":f.endpointUrl,(m=[]).push((i="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",t=h,u=d,(s=(v=w(p,"Exception")).data).baseType="ExceptionData",s.baseData.exceptions=[{typeName:"SDKLoadFailed",message:i.replace(/\./g,"-"),hasFullStack:!1,stack:i+"\nSnippet failed to load ["+t+"] -- Telemetry is disabled\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\nHost: "+(e&&e.pathname||"_unknown_")+"\nEndpoint: "+u,parsedStack:[]}],v)),m.push(function(g,f,d,e){var b=w(p,"Message"),c=b.data,a;return c.baseType="MessageData",a=c.baseData,a.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+d+")").replace(/\"/g,"")+'"',a.properties={endpoint:e},b}(0,0,h,d)),function(e,f){var d,c;JSON&&(d=b.fetch,d&&!a.useXhr?d(f,{method:l,body:JSON.stringify(e),mode:"cors"}):XMLHttpRequest&&(c=new XMLHttpRequest,c.open(l,f),c.setRequestHeader("Content-type","application/json"),c.send(JSON.stringify(e))))}(m,d))}function t(b,a){q||setTimeout(function(){!a&&c.core||u()},500)}s=function(){var b=d.createElement(o),c;return b.src=r,c=a[h],!c&&""!==c||"undefined"==b[h]||(b[h]=c),b.onload=t,b.onerror=u,b.onreadystatechange=function(c,a){"loaded"!==b.readyState&&"complete"!==b.readyState||t(0,a)},b}(),a.ld<0?d.getElementsByTagName("head")[0].appendChild(s):setTimeout(function(){d.getElementsByTagName(o)[0].parentNode.appendChild(s)},a.ld||0)}try{c.cookie=d.cookie}catch(a){}function v(a){for(;a.length;)!function(a){c[a]=function(){var b=arguments;z||c.queue.push(function(){c[a].apply(c,b)})}}(a.pop())}return m="track",x="TrackPage",y="TrackEvent",v([m+"Event",m+"PageView",m+"Exception",m+"Trace",m+"DependencyData",m+"Metric",m+"PageViewPerformance","start"+x,"stop"+x,"start"+y,"stop"+y,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),c.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4},B=(f.extensionConfig||{}).ApplicationInsightsAnalytics||{},!0!==f[k]&&!0!==B[k]&&(p="onerror",v(["_"+p]),A=b[p],b[p]=function(a,b,d,e,f){var g=A&&A(a,b,d,e,f);return!0!==g&&c["_"+p]({message:a,url:b,lineNumber:d,columnNumber:e,error:f}),g},f.autoExceptionInstrumented=!0),c}(a.cfg);function p(){a.onInit&&a.onInit(c)}(b[f]=c).queue&&0===c.queue.length?(c.queue.push(p),c.trackPageView({})):p()}(window,document,{src:"https://js.monitor.azure.com/scripts/b/ai.2.min.js",crossOrigin:"anonymous",cfg:{connectionString:"InstrumentationKey=74cc5c48-d066-4928-932e-459f438b579d;IngestionEndpoint=https://uksouth-1.in.applicationinsights.azure.com/;LiveEndpoint=https://uksouth.livediagnostics.monitor.azure.com/"}})</script></head><body><div class=container><header><section><h1 class=site-heading>Stuart McColl</h1><nav><ul><li><a href=/>Blog</a></li><li><a href=/about>About</a></li></ul></nav></section></header><hr><div class=content><main class=post><article><header><h1 class=post-title>Automate the shutdown of a Windows 10 PC</h1><p class=post-date>October 14, 2020</p></header><hr class=post-rule><div class=post-content><h2 id=using-the-shutdown-command>Using the <code>shutdown</code> command</h2><p>Setting a single, non-repeatable shutdown timer can be done using the <code>shutdown</code> command, which can be run in the Command Prompt or PowerShell. Let&rsquo;s use PowerShell as an example.</p><ol><li>Search for &lsquo;<em>PowerShell</em>&rsquo; in the start menu and open the app that is returned.</li><li>Run the command <code>shutdown -s -t TimeInSeconds</code> where <code>TimeInSeconds</code> is replaced with the number of seconds after which you want the Windows 10 PC to shutdown. For example, if you want it to shutdown after 30 minutes, then replace <code>TimeInSeconds</code> with <code>1800</code>. The <code>-s</code> flag is simply telling the command to shutdown, as opposed to logging out, or restarting, etc.</li></ol><p>That&rsquo;s it - you&rsquo;ve scheduled a one-time shutdown of your Windows 10 PC.</p><p>If you&rsquo;d like to cancel your scheduled one-time shutdown, you can run the <code>shutdown</code> command again, this time only passing the <code>-a</code> flag: <code>shutdown -a</code>.</p><p>What about if you want to automate your shutdown schedule? That&rsquo;s where the Windows Task Scheduler comes in.</p><h2 id=using-task-scheduler>Using Task Scheduler</h2><ol><li>Search for &lsquo;<em>Task Scheduler</em>&rsquo; in the start menu and open the app that is returned.</li><li>Once opened, select the &lsquo;<em>Create basic task</em>&rsquo; option. This will open a &lsquo;<em>Basic Task Creation Wizard</em>&rsquo;.</li><li>Within the wizard, enter a name for this task. The description field is optional. Let&rsquo;s call ours &lsquo;<strong>Shutdown</strong>&rsquo;, then click the &lsquo;<em>Next</em>&rsquo; button.</li><li>The wizard will present you with a list of radio button options for how often you want your task to run. You can choose options such as daily or weekly, as well as other more specific options such as &lsquo;<em>one time</em>&rsquo; or &lsquo;<em>when the computer starts</em>&rsquo;. Choose the option appropriate to your use case, here we&rsquo;ll go with &lsquo;<em>one time</em>&rsquo;.</li><li>The wizard will present you with the option of specifying a date and time for the task to run. Again, choose the option appropriate to your use case.</li><li>Finally, the wizard will present you with the option of a program or script to run, as well as aguments to pass when running. As we&rsquo;re creating a task to shutdown our Windows 10 PC, enter <code>shutdown.exe</code> in the <em>&lsquo;Program/script</em>&rsquo; field, and then enter <code>/s</code> in the &lsquo;<em>Add arguments (optional)</em>&rsquo; field. Click the &lsquo;<em>Next</em>&rsquo; button.</li><li>The wizard will present you with an overview of your task. Confirm that everything is okay by clicking the &lsquo;<em>Finish</em>&rsquo; button.</li></ol><p>That&rsquo;s all there is to it. If necessary you can test your created task by finding it in the Task Scheduler, right clicking it and then selecting &lsquo;<em>Run</em>&rsquo; from the menu that appears. Likewise, to disable your task, right click it and select &lsquo;<em>Disable</em>&rsquo; from the menu that appears.</p></div></article></main></div><hr><footer><section><h3>More</h3><ul><li><a href=https://hachyderm.io/@stuartmccoll rel=me>Contact me on Mastodon</a></li><li>Spotted a bug in the site?
<a href=https://github.com/stuartmccoll/hugo-theme-refresh/issues/new>Raise an issue on GitHub</a></li><li>Get notifications of new posts by
<a href=https://stuartmccoll.github.io/index.xml>subscribing to my RSS feed</a></li><li>This static site was generated using
<a href=https://github.com/gohugoio/hugo/releases/tag/v0.83.1>Hugo version 0.83.1</a></li></ul></section><hr><section><h3>Attribution</h3><p xmlns:dct=http://purl.org/dc/terms/ xmlns:cc=http://creativecommons.org/ns# class=license-text>This blog post <span rel=dct:title>(Automate the shutdown of a Windows 10 PC)</span> is licensed under
<a href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a>. Any code contained within
this article may be subject to other licenses.</p></section></footer></div></body></html>