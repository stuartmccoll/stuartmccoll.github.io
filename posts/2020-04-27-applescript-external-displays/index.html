<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Stuart McColl "><meta name=description content="AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.
I&amp;rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros. Sometimes the resolutions stick when switching between the two, sometimes they don&amp;rsquo;t. Rather than have to go into System Preferences &amp;gt; Displays and set them whenever the settings don&amp;rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me."><meta name=keywords content="homepage,blog,development,programming"><meta name=robots content="noodp"><link rel=canonical href=https://stuartmccoll.github.io/posts/2020-04-27-applescript-external-displays/><title>AppleScript for Configuring External Displays :: Stuart McColl</title><link rel=stylesheet href=/main.min.15c204e66791e2f70ca06e7872b0ed743b4d2392b3c6dc31ba8dbd9f3d4618d2.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><meta name=theme-color content="#252627"><meta itemprop=name content="AppleScript for Configuring External Displays"><meta itemprop=description content="AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.
I&rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros. Sometimes the resolutions stick when switching between the two, sometimes they don&rsquo;t. Rather than have to go into System Preferences > Displays and set them whenever the settings don&rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me."><meta itemprop=datePublished content="2020-04-27T20:00:00+00:00"><meta itemprop=dateModified content="2020-04-27T20:00:00+00:00"><meta itemprop=wordCount content="683"><meta itemprop=image content="https://stuartmccoll.github.io"><meta itemprop=keywords content="applescript,display,external,resolution,macos,"><meta property="article:published_time" content="2020-04-27 20:00:00 +0000 UTC"><script type=text/javascript>!function(b,d,a){var e=b.location,o="script",n="instrumentationKey",g="ingestionendpoint",k="disableExceptionTracking",i="ai.device.",j="toLowerCase",h="crossOrigin",l="POST",m="appInsightsSDK",f=a.name||"appInsights",c;(a.name||b[m])&&(b[m]=f),c=b[f]||function(f){var z=!1,q=!1,c={initialize:!0,queue:[],sv:"5",version:2,config:f},r,s,m,x,y,B,p,A;function w(b,f){var a={},d="Browser";return a[i+"id"]=d[j](),a[i+"type"]=d,a["ai.operation.name"]=e&&e.pathname||"_unknown_",a["ai.internal.sdkVersion"]="javascript:snippet_"+(c.sv||c.version),{time:function(){var a=new Date;function b(b){var a=""+b;return 1===a.length&&(a="0"+a),a}return a.getUTCFullYear()+"-"+b(1+a.getUTCMonth())+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+((a.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:b,name:"Microsoft.ApplicationInsights."+b.replace(/-/g,"")+"."+f,sampleRate:100,tags:a,data:{baseData:{ver:2}}}}if(r=f.url||a.src,r){function u(x){var h,i,t,u,v,s,o,p,k,d,m;z=!0,c.queue=[],q||(q=!0,h=r,o=function(){var a={},d=f.connectionString,e,b,c,h,i;if(d)for(e=d.split(";"),b=0;b<e.length;b++)c=e[b].split("="),2===c.length&&(a[c[0][j]()]=c[1]);return a[g]||(h=a.endpointsuffix,i=h?a.location:null,a[g]="https://"+(i?i+".":"")+"dc."+(h||"services.visualstudio.com")),a}(),p=o[n]||f[n]||"",k=o[g],d=k?k+"/v2/track":f.endpointUrl,(m=[]).push((i="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",t=h,u=d,(s=(v=w(p,"Exception")).data).baseType="ExceptionData",s.baseData.exceptions=[{typeName:"SDKLoadFailed",message:i.replace(/\./g,"-"),hasFullStack:!1,stack:i+"\nSnippet failed to load ["+t+"] -- Telemetry is disabled\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\nHost: "+(e&&e.pathname||"_unknown_")+"\nEndpoint: "+u,parsedStack:[]}],v)),m.push(function(g,f,d,e){var b=w(p,"Message"),c=b.data,a;return c.baseType="MessageData",a=c.baseData,a.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+d+")").replace(/\"/g,"")+'"',a.properties={endpoint:e},b}(0,0,h,d)),function(e,f){var d,c;JSON&&(d=b.fetch,d&&!a.useXhr?d(f,{method:l,body:JSON.stringify(e),mode:"cors"}):XMLHttpRequest&&(c=new XMLHttpRequest,c.open(l,f),c.setRequestHeader("Content-type","application/json"),c.send(JSON.stringify(e))))}(m,d))}function t(b,a){q||setTimeout(function(){!a&&c.core||u()},500)}s=function(){var b=d.createElement(o),c;return b.src=r,c=a[h],!c&&""!==c||"undefined"==b[h]||(b[h]=c),b.onload=t,b.onerror=u,b.onreadystatechange=function(c,a){"loaded"!==b.readyState&&"complete"!==b.readyState||t(0,a)},b}(),a.ld<0?d.getElementsByTagName("head")[0].appendChild(s):setTimeout(function(){d.getElementsByTagName(o)[0].parentNode.appendChild(s)},a.ld||0)}try{c.cookie=d.cookie}catch(a){}function v(a){for(;a.length;)!function(a){c[a]=function(){var b=arguments;z||c.queue.push(function(){c[a].apply(c,b)})}}(a.pop())}return m="track",x="TrackPage",y="TrackEvent",v([m+"Event",m+"PageView",m+"Exception",m+"Trace",m+"DependencyData",m+"Metric",m+"PageViewPerformance","start"+x,"stop"+x,"start"+y,"stop"+y,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),c.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4},B=(f.extensionConfig||{}).ApplicationInsightsAnalytics||{},!0!==f[k]&&!0!==B[k]&&(p="onerror",v(["_"+p]),A=b[p],b[p]=function(a,b,d,e,f){var g=A&&A(a,b,d,e,f);return!0!==g&&c["_"+p]({message:a,url:b,lineNumber:d,columnNumber:e,error:f}),g},f.autoExceptionInstrumented=!0),c}(a.cfg);function p(){a.onInit&&a.onInit(c)}(b[f]=c).queue&&0===c.queue.length?(c.queue.push(p),c.trackPageView({})):p()}(window,document,{src:"https://js.monitor.azure.com/scripts/b/ai.2.min.js",crossOrigin:"anonymous",cfg:{connectionString:"InstrumentationKey=74cc5c48-d066-4928-932e-459f438b579d;IngestionEndpoint=https://uksouth-1.in.applicationinsights.azure.com/;LiveEndpoint=https://uksouth.livediagnostics.monitor.azure.com/"}})</script></head><body><div class=container><header><section><h1 class=site-heading>Stuart McColl</h1><nav><ul><li><a href=/>Blog</a></li><li><a href=/about>About</a></li></ul></nav></section></header><hr><div class=content><main class=post><article><header><h1 class=post-title>AppleScript for Configuring External Displays</h1><p class=post-date>April 27, 2020</p></header><hr class=post-rule><div class=post-content><p>AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.</p><p>I&rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros.
Sometimes the resolutions stick when switching between the two, sometimes they don&rsquo;t. Rather than have to go into <code>System Preferences > Displays</code> and set them whenever the
settings don&rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me. That&rsquo;s where AppleScript comes in.</p><p>There are different ways of running AppleScripts - I&rsquo;m not going to cover that here. Options include running from the command line, running as a bundled application, running
from <a href=https://www.alfredapp.com>Alfred</a>, etc.</p><p>I managed to cobble together a sloppy script to automate setting the resolution of my displays, which I&rsquo;ll detail below. Prior warning - I haven&rsquo;t done any cleanup; there&rsquo;s
plenty that could be refactored - for example, it could be one function which you pass parameters to and call for each display you want to set. Go with it for now.</p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=k>tell</span> <span class=nb>application</span> <span class=s2>&#34;System Preferences&#34;</span>
  <span class=nv>reveal</span> <span class=nv>anchor</span> <span class=s2>&#34;displaysDisplayTab&#34;</span> <span class=k>of</span> <span class=nv>pane</span> <span class=na>id</span> <span class=s2>&#34;com.apple.preference.displays&#34;</span>
<span class=k>end</span> <span class=k>tell</span>
</code></pre></div><p>This opens <code>System Preferences > Displays</code> and then ensures that the <code>Display</code> tab is open.</p><p><img src=/img/20200427-display.png alt="System Preferences > Displays"></p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=k>tell</span> <span class=nb>application</span> <span class=s2>&#34;System Events&#34;</span> <span class=k>to</span> <span class=k>tell</span> <span class=nv>process</span> <span class=s2>&#34;System Preferences&#34;</span> <span class=k>to</span> <span class=k>tell</span> <span class=na>window</span> <span class=s2>&#34;Built-in Retina Display&#34;</span>
  <span class=k>set</span> <span class=nv>is_scaled</span> <span class=k>to</span> <span class=nv>value</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=s2>&#34;Scaled&#34;</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
  <span class=k>if</span> <span class=nv>is_scaled</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>then</span>
    <span class=nv>click</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=s2>&#34;Scaled&#34;</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
    <span class=nv>click</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=mi>5</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
  <span class=k>else</span>
    <span class=k>set</span> <span class=nv>scale_value</span> <span class=k>to</span> <span class=nv>value</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
    <span class=k>if</span> <span class=nv>scale_value</span> <span class=ow>is not</span> <span class=ow>equal to</span> <span class=mi>5</span> <span class=k>then</span>
      <span class=nv>click</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=mi>5</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
    <span class=k>end</span> <span class=k>if</span>
  <span class=k>end</span> <span class=k>if</span>
<span class=k>end</span> <span class=k>tell</span>
</code></pre></div><p>This is the bulk of the script, which I essentially duplicate this for both external displays. Let&rsquo;s break down what&rsquo;s happening here.</p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=k>tell</span> <span class=nb>application</span> <span class=s2>&#34;System Events&#34;</span> <span class=k>to</span> <span class=k>tell</span> <span class=nv>process</span> <span class=s2>&#34;System Preferences&#34;</span> <span class=k>to</span> <span class=k>tell</span> <span class=na>window</span> <span class=s2>&#34;Built-in Retina Display&#34;</span>
<span class=p>...</span>
<span class=k>end</span> <span class=k>tell</span>
</code></pre></div><p>This <code>tell</code> block ensures that I&rsquo;m targeting the &ldquo;Built-in Retina Display&rdquo; window. I also have two separate <code>tell</code> blocks for my external displays, where instead of using
<code>tell window "Built-in Retina Display"</code>, I use <code>tell window "U28E590 (1)"</code> and <code>tell window "U28E590 (2)"</code>. This is what I meant about my lack of refactoring; you could easily
make this a function and pass the display name as an argument.</p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=k>set</span> <span class=nv>is_scaled</span> <span class=k>to</span> <span class=nv>value</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=s2>&#34;Scaled&#34;</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
</code></pre></div><p>This sets the value of the &ldquo;Scaled&rdquo; radio button to a variable, which we can then check.</p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=k>if</span> <span class=nv>is_scaled</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>then</span>
    <span class=nv>click</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=s2>&#34;Scaled&#34;</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
    <span class=nv>click</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=mi>5</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
  <span class=k>else</span>
    <span class=p>...</span>
  <span class=k>end</span> <span class=k>if</span>
</code></pre></div><p>If the &ldquo;Scaled&rdquo; radio button has a value of <code>0</code>, then that means that it hasn&rsquo;t been clicked. We click the &ldquo;Scaled&rdquo; radio button and then select the appropriate resolution
size from within the &ldquo;Scaled&rdquo; submenu. In this code example, <code>radio button 5</code> is the &ldquo;More Space&rdquo; setting.</p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=k>if</span> <span class=nv>is_scaled</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>then</span>
    <span class=p>...</span>
  <span class=k>else</span>
    <span class=k>set</span> <span class=nv>scale_value</span> <span class=k>to</span> <span class=nv>value</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
    <span class=k>if</span> <span class=nv>scale_value</span> <span class=ow>is not</span> <span class=ow>equal to</span> <span class=mi>5</span> <span class=k>then</span>
      <span class=nv>click</span> <span class=nv>radio</span> <span class=nb>button</span> <span class=mi>5</span> <span class=k>of</span> <span class=nv>radio</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=nv>group</span> <span class=mi>1</span> <span class=k>of</span> <span class=no>tab</span> <span class=nv>group</span> <span class=mi>1</span>
    <span class=k>end</span> <span class=k>if</span>
  <span class=k>end</span> <span class=k>if</span>
</code></pre></div><p>In the <code>else</code> block, &ldquo;Scaled&rdquo; was already selected. In this case, we want to make sure that the appropriate resolution size from within the &ldquo;Scaled&rdquo; submenu is selected. Here,
we set the currently selected resolution size to the <code>scale_value</code> variable. We then check whether it&rsquo;s equal to the value we want (in this case <code>5</code>). If it isn&rsquo;t, then we set it. If it&rsquo;s already set to <code>5</code>, then we don&rsquo;t need to click it again.</p><div class=highlight><pre class=chroma><code class=language-applescript data-lang=applescript><span class=nb>quit</span> <span class=nb>application</span> <span class=s2>&#34;System Preferences&#34;</span>
</code></pre></div><p>This line is self-explanatory.</p><p>And that&rsquo;s it.</p></div></article></main></div><hr><footer><section><h3>More</h3><ul><li><a href=https://hachyderm.io/@stuartmccoll rel=me>Contact me on Mastodon</a></li><li>Spotted a bug in the site?
<a href=https://github.com/stuartmccoll/hugo-theme-refresh/issues/new>Raise an issue on GitHub</a></li><li>Get notifications of new posts by
<a href=https://stuartmccoll.github.io/index.xml>subscribing to my RSS feed</a></li><li>This static site was generated using
<a href=https://github.com/gohugoio/hugo/releases/tag/v0.83.1>Hugo version 0.83.1</a></li></ul></section><hr><section><h3>Attribution</h3><p xmlns:dct=http://purl.org/dc/terms/ xmlns:cc=http://creativecommons.org/ns# class=license-text>This blog post <span rel=dct:title>(AppleScript for Configuring External Displays)</span> is licensed under
<a href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a>. Any code contained within
this article may be subject to other licenses.</p></section></footer></div></body></html>