<!DOCTYPE html>
<html lang="en-GB">

    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Stuart McColl ">
<meta name="description"
    content="AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.
I&amp;rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros. Sometimes the resolutions stick when switching between the two, sometimes they don&amp;rsquo;t. Rather than have to go into System Preferences &amp;gt; Displays and set them whenever the settings don&amp;rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me." />
<meta name="keywords" content="homepage, blog, development, programming" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://stuartmccoll.github.io/posts/2020-04-27-applescript-external-displays/" />
<title>
    AppleScript for Configuring External Displays :: Stuart McColl 
</title>
<link rel="stylesheet" href="/main.min.eb1b7d3000a8275af4d8e79188963265e6f59cededf319c3200e043f9b86a0ab.css"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="AppleScript for Configuring External Displays">
<meta itemprop="description" content="AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.
I&rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros. Sometimes the resolutions stick when switching between the two, sometimes they don&rsquo;t. Rather than have to go into System Preferences &gt; Displays and set them whenever the settings don&rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me."><meta itemprop="datePublished" content="2020-04-27T20:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-04-27T20:00:00&#43;00:00" />
<meta itemprop="wordCount" content="683"><meta itemprop="image" content="https://stuartmccoll.github.io"/>
<meta itemprop="keywords" content="applescript,display,external,resolution,macos," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://stuartmccoll.github.io"/>

<meta name="twitter:title" content="AppleScript for Configuring External Displays"/>
<meta name="twitter:description" content="AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.
I&rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros. Sometimes the resolutions stick when switching between the two, sometimes they don&rsquo;t. Rather than have to go into System Preferences &gt; Displays and set them whenever the settings don&rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me."/>

<meta property="article:published_time" content="2020-04-27 20:00:00 &#43;0000 UTC" />
    </head>

    <body>
        <div class="container">
            <header>
    <section>
        <h1 class="site-heading">Stuart McColl</h1>
        <nav>
            <ul>
                <li><a href="/">Blog</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
    </section>
</header>

<hr />

            <div class="content">
                
<main class="post">

    <article>
        <header>
            <h1 class="post-title">AppleScript for Configuring External Displays</h1>
            <p class="post-date">April 27, 2020</p>
        </header>

        <hr class="post-rule" />

        <div class="post-content">
            <p>AppleScript is a scripting language bundled within all versions of macOS, which allows for scripting of elements of the operating system and compatible applications.</p>
<p>I&rsquo;d never touched it before, but decided to try to use it to automate setting the resolutions of my external displays when switching between my personal and work MacBook Pros.
Sometimes the resolutions stick when switching between the two, sometimes they don&rsquo;t. Rather than have to go into <code>System Preferences &gt; Displays</code> and set them whenever the
settings don&rsquo;t stick, I quite liked the idea of just running a script and having something else take care of it for me. That&rsquo;s where AppleScript comes in.</p>
<p>There are different ways of running AppleScripts - I&rsquo;m not going to cover that here. Options include running from the command line, running as a bundled application, running
from <a href="https://www.alfredapp.com">Alfred</a>, etc.</p>
<p>I managed to cobble together a sloppy script to automate setting the resolution of my displays, which I&rsquo;ll detail below. Prior warning - I haven&rsquo;t done any cleanup; there&rsquo;s
plenty that could be refactored - for example, it could be one function which you pass parameters to and call for each display you want to set. Go with it for now.</p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&#34;System Preferences&#34;</span>
	<span class="nv">reveal</span> <span class="nv">anchor</span> <span class="s2">&#34;displaysDisplayTab&#34;</span> <span class="k">of</span> <span class="nv">pane</span> <span class="na">id</span> <span class="s2">&#34;com.apple.preference.displays&#34;</span>
<span class="k">end</span> <span class="k">tell</span>
</code></pre></div><p>This opens <code>System Preferences &gt; Displays</code> and then ensures that the <code>Display</code> tab is open.</p>
<p><img src="/img/20200427-display.png" alt="System Preferences > Displays"></p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&#34;System Events&#34;</span> <span class="k">to</span> <span class="k">tell</span> <span class="nv">process</span> <span class="s2">&#34;System Preferences&#34;</span> <span class="k">to</span> <span class="k">tell</span> <span class="na">window</span> <span class="s2">&#34;Built-in Retina Display&#34;</span>
	<span class="k">set</span> <span class="nv">is_scaled</span> <span class="k">to</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="s2">&#34;Scaled&#34;</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="nv">is_scaled</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
		<span class="nv">click</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="s2">&#34;Scaled&#34;</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
		<span class="nv">click</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="mi">5</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
	<span class="k">else</span>
		<span class="k">set</span> <span class="nv">scale_value</span> <span class="k">to</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="nv">scale_value</span> <span class="ow">is not</span> <span class="ow">equal to</span> <span class="mi">5</span> <span class="k">then</span>
			<span class="nv">click</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="mi">5</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
		<span class="k">end</span> <span class="k">if</span>
	<span class="k">end</span> <span class="k">if</span>
<span class="k">end</span> <span class="k">tell</span>
</code></pre></div><p>This is the bulk of the script, which I essentially duplicate this for both external displays. Let&rsquo;s break down what&rsquo;s happening here.</p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&#34;System Events&#34;</span> <span class="k">to</span> <span class="k">tell</span> <span class="nv">process</span> <span class="s2">&#34;System Preferences&#34;</span> <span class="k">to</span> <span class="k">tell</span> <span class="na">window</span> <span class="s2">&#34;Built-in Retina Display&#34;</span>
<span class="p">...</span>
<span class="k">end</span> <span class="k">tell</span>
</code></pre></div><p>This <code>tell</code> block ensures that I&rsquo;m targeting the &ldquo;Built-in Retina Display&rdquo; window. I also have two separate <code>tell</code> blocks for my external displays, where instead of using
<code>tell window &quot;Built-in Retina Display&quot;</code>, I use <code>tell window &quot;U28E590 (1)&quot;</code> and <code>tell window &quot;U28E590 (2)&quot;</code>. This is what I meant about my lack of refactoring; you could easily
make this a function and pass the display name as an argument.</p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="k">set</span> <span class="nv">is_scaled</span> <span class="k">to</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="s2">&#34;Scaled&#34;</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
</code></pre></div><p>This sets the value of the &ldquo;Scaled&rdquo; radio button to a variable, which we can then check.</p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="k">if</span> <span class="nv">is_scaled</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
		<span class="nv">click</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="s2">&#34;Scaled&#34;</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
		<span class="nv">click</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="mi">5</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
	<span class="k">else</span>
		<span class="p">...</span>
	<span class="k">end</span> <span class="k">if</span>
</code></pre></div><p>If the &ldquo;Scaled&rdquo; radio button has a value of <code>0</code>, then that means that it hasn&rsquo;t been clicked. We click the &ldquo;Scaled&rdquo; radio button and then select the appropriate resolution
size from within the &ldquo;Scaled&rdquo; submenu. In this code example, <code>radio button 5</code> is the &ldquo;More Space&rdquo; setting.</p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="k">if</span> <span class="nv">is_scaled</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
		<span class="p">...</span>
	<span class="k">else</span>
		<span class="k">set</span> <span class="nv">scale_value</span> <span class="k">to</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="nv">scale_value</span> <span class="ow">is not</span> <span class="ow">equal to</span> <span class="mi">5</span> <span class="k">then</span>
			<span class="nv">click</span> <span class="nv">radio</span> <span class="nb">button</span> <span class="mi">5</span> <span class="k">of</span> <span class="nv">radio</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="no">tab</span> <span class="nv">group</span> <span class="mi">1</span>
		<span class="k">end</span> <span class="k">if</span>
	<span class="k">end</span> <span class="k">if</span>
</code></pre></div><p>In the <code>else</code> block, &ldquo;Scaled&rdquo; was already selected. In this case, we want to make sure that the appropriate resolution size from within the &ldquo;Scaled&rdquo; submenu is selected. Here,
we set the currently selected resolution size to the <code>scale_value</code> variable. We then check whether it&rsquo;s equal to the value we want (in this case <code>5</code>). If it isn&rsquo;t, then we set it. If it&rsquo;s already set to <code>5</code>, then we don&rsquo;t need to click it again.</p>
<div class="highlight"><pre class="chroma"><code class="language-applescript" data-lang="applescript"><span class="nb">quit</span> <span class="nb">application</span> <span class="s2">&#34;System Preferences&#34;</span>
</code></pre></div><p>This line is self-explanatory.</p>
<p>And that&rsquo;s it.</p>

        </div>
    </article>

</main>

            </div>

            

            <hr />

            <footer>
    
    
    
    <section>
        <h3>Share this content</h3>
        <p>
            <a
                href="https://twitter.com/intent/tweet?url=https://stuartmccoll.github.io%2fposts%2f2020-04-27-applescript-external-displays%2f&via=itstuartmccoll&text=I%27m%20reading">
                Tweet this blog post
            </a>
        </p>
    </section>
    <hr />
    
    
    
    <section>
        <h3>More</h3>
        <ul>
            
            <li>
                <a
                    href="https://twitter.com/intent/tweet?text=%40itstuartmccoll%20Hello%2C%20%3Cinsert%20message%20here%3E">
                    Contact me on Twitter
                </a>
            </li>
            
            
            <li>Spotted a bug in the site?
                <a href="https://github.com/stuartmccoll/hugo-theme-refresh/issues/new">
                    Raise an issue on GitHub
                </a>
            </li>
            
            <li>Get notifications of new posts by
                <a href="https://stuartmccoll.github.io/index.xml">
                    subscribing to my RSS feed
                </a>
            </li>
            
            <li>This static site was generated using
                <a href="https://github.com/gohugoio/hugo/releases/tag/v0.82.0">
                    Hugo version 0.82.0
                </a>
            </li>
            
        </ul>
    </section>
    <hr />
    
    <section>
        <h3>Attribution</h3>
        <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
            
            This blog post <span rel="dct:title">(AppleScript for Configuring External Displays)</span> is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a>. Any code contained within
            this article may be subject to other licenses.
            
        </p>
    </section>
    
</footer>

            
        </div>
    </body>

</html>