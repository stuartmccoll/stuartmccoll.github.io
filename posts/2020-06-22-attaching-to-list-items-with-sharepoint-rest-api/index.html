<!DOCTYPE html>
<html lang="en-GB">

    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Stuart McColl ">
<meta name="description"
    content="In my last blog post I explained how to create list items with Microsoft&amp;rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to attach a file to an existing list item.
 Assuming you&amp;rsquo;ve been following along, we have a SharePoint list with at least one item in it that we&amp;rsquo;ve created through a request sent from Postman to the Microsoft SharePoint REST API. The item we created will have been assigned an id within SharePoint." />
<meta name="keywords" content="homepage, blog, development, programming" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://stuartmccoll.github.io/posts/2020-06-22-attaching-to-list-items-with-sharepoint-rest-api/" />
<title>
    Attaching to list items with the Microsoft SharePoint REST API :: Stuart McColl 
</title>
<link rel="stylesheet" href="/main.min.47950748411c0ef3c7ae5e73073e0d5dfe7c26792aa521a159b90d6ba5bf68e2.css"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Attaching to list items with the Microsoft SharePoint REST API">
<meta itemprop="description" content="In my last blog post I explained how to create list items with Microsoft&rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to attach a file to an existing list item.
 Assuming you&rsquo;ve been following along, we have a SharePoint list with at least one item in it that we&rsquo;ve created through a request sent from Postman to the Microsoft SharePoint REST API. The item we created will have been assigned an id within SharePoint.">
<meta itemprop="datePublished" content="2020-06-22T16:00:48+01:00" />
<meta itemprop="dateModified" content="2020-06-22T16:00:48+01:00" />
<meta itemprop="wordCount" content="319">
<meta itemprop="image" content="https://stuartmccoll.github.io"/>



<meta itemprop="keywords" content="microsoft,sharepoint,rest,api,postman," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://stuartmccoll.github.io"/>

<meta name="twitter:title" content="Attaching to list items with the Microsoft SharePoint REST API"/>
<meta name="twitter:description" content="In my last blog post I explained how to create list items with Microsoft&rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to attach a file to an existing list item.
 Assuming you&rsquo;ve been following along, we have a SharePoint list with at least one item in it that we&rsquo;ve created through a request sent from Postman to the Microsoft SharePoint REST API. The item we created will have been assigned an id within SharePoint."/>

<meta property="article:published_time" content="2020-06-22 16:00:48 &#43;0100 BST" />
    </head>

    <body>
        <div class="container">
            <header>
    <section>
        <h1 class="site-heading">Stuart McColl</h1>
        <nav>
            <ul>
                <li><a href="/">Blog</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
    </section>
</header>

<hr />

            <div class="content">
                
<main class="post">

    <article>
        <header>
            <h1 class="post-title">Attaching to list items with the Microsoft SharePoint REST API</h1>
            <p class="post-date">June 22, 2020</p>
        </header>

        <hr class="post-rule" />

        <div class="post-content">
            <p>In my <a href="../2020-06-18-creating-list-items-with-sharepoint-rest-api">last blog post</a> I explained how to create list items with Microsoft&rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to attach a file to an existing list item.</p>
<hr>
<p>Assuming you&rsquo;ve been following along, we have a SharePoint list with at least one item in it that we&rsquo;ve created through a request sent from Postman to the Microsoft SharePoint REST API. The item we created will have been assigned an <code>id</code> within SharePoint. If you don&rsquo;t still have the response from our creation request to hand (which will have contained the ID in the response body), you can obtain it from SharePoint. Access the list item and then click the &lsquo;Copy Link&rsquo; shortcut. A URL will be copied to your clipboard which looks like the following:</p>
<pre><code>https://contoso.sharepoint.com/Lists/Test%20list/DispForm.aspx?ID=1&amp;e=...
</code></pre><p>The <code>id</code> we need is right there in the URL, within the <code>ID</code> parameter.</p>
<p>Let&rsquo;s add an attachment to this list item. Open a new Postman request, which we&rsquo;ll be sending as a <code>POST</code>. Use the following details, where <code>contoso</code> is replaced with your own tenant name, <code>Test list</code> is replaced with your own SharePoint list name, and <code>id</code> with your own list item identifier as discussed above:</p>
<div class="highlight"><pre class="chroma"><code class="language-http" data-lang="http"><span class="err">POST https://contoso.sharepoint.com/_api/web/lists/GetByTitle(&#39;Test list&#39;)/items(1)/AttachmentFiles/add(FileName=&#39;microsoft-logo.jpg&#39;)
</span><span class="err">Authorization: Bearer {{appReg_bearerToken}}
</span></code></pre></div><p>We&rsquo;re going to do something different this time. Select the &lsquo;Body&rsquo; tab and then the &lsquo;binary&rsquo; radio button. You should see a &lsquo;Select File&rsquo; button. We&rsquo;re going to upload the following image as our attachment:</p>
<p><img src="/img/microsoft-logo.jpg" alt="Microsoft logo"></p>
<p>Click the &lsquo;Select File&rsquo; button and then select the <code>microsoft-logo.jpg</code> file. Now click &lsquo;Send&rsquo; to send our <code>POST</code> request to the SharePoint REST API. You should receive a <code>200</code> HTTP status code in response, with an XML response body. The XML will contain some details about the attachment, such as the server relative path, etc. If you now browse to your list item within SharePoint you should be able to see that we&rsquo;ve successfully attached our file.</p>

        </div>
    </article>

</main>

            </div>

            

            <hr />

            <footer>
    
    
    
    <section>
        <h3>Share this content</h3>
        <p>
            <a
                href="https://twitter.com/intent/tweet?url=https://stuartmccoll.github.io%2fposts%2f2020-06-22-attaching-to-list-items-with-sharepoint-rest-api%2f&via=itstuartmccoll&text=I%27m%20reading">
                Tweet this blog post
            </a>
        </p>
    </section>
    <hr />
    
    
    
    <section>
        <h3>More</h3>
        <ul>
            
            <li>
                <a
                    href="https://twitter.com/intent/tweet?text=%40itstuartmccoll%20Hello%2C%20%3Cinsert%20message%20here%3E">
                    Contact me on Twitter
                </a>
            </li>
            
            
            <li>Spotted a bug in the site?
                <a href="https://github.com/stuartmccoll/hugo-theme-refresh/issues/new">
                    Raise an issue on GitHub
                </a>
            </li>
            
            <li>Get notifications of new posts by
                <a href="https://stuartmccoll.github.io/index.xml">
                    subscribing to my RSS feed
                </a>
            </li>
            
            <li>This static site was generated using
                <a href="https://github.com/gohugoio/hugo/releases/tag/v0.75.1">
                    Hugo version 0.75.1
                </a>
            </li>
            
        </ul>
    </section>
    <hr />
    
    <section>
        <h3>Attribution</h3>
        <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
            
            This blog post <span rel="dct:title">(Attaching to list items with the Microsoft SharePoint REST API)</span> is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a>. Any code contained within
            this article may be subject to other licenses.
            
        </p>
    </section>
    
</footer>

            
        </div>
    </body>

</html>