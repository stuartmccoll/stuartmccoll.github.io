<!DOCTYPE html>
<html lang="en-GB">

    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Stuart McColl ">
<meta name="description"
    content="In my last blog post I explained how to authenticate requests to Microsoft&amp;rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to store our access token as a Postman environment variable and to then send POST requests to the SharePoint REST API to create new items within an existing SharePoint list.
 If you were following along previously, the last thing we did was to request an access token to use in future requests." />
<meta name="keywords" content="homepage, blog, development, programming" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://stuartmccoll.github.io/posts/2020-06-18-creating-list-items-with-sharepoint-rest-api/" />
<title>
    Creating list items with the Microsoft SharePoint REST API :: Stuart McColl 
</title>
<link rel="stylesheet" href="/main.min.9b276610b5993837f29d9c1e20b9e04db4f387b683b8034a6bf96f7fbfad81dc.css"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Creating list items with the Microsoft SharePoint REST API">
<meta itemprop="description" content="In my last blog post I explained how to authenticate requests to Microsoft&rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to store our access token as a Postman environment variable and to then send POST requests to the SharePoint REST API to create new items within an existing SharePoint list.
 If you were following along previously, the last thing we did was to request an access token to use in future requests.">
<meta itemprop="datePublished" content="2020-06-18T19:30:00&#43;01:00" />
<meta itemprop="dateModified" content="2020-06-18T19:30:00&#43;01:00" />
<meta itemprop="wordCount" content="587">
<meta itemprop="image" content="https://stuartmccoll.github.io"/>



<meta itemprop="keywords" content="microsoft,sharepoint,rest,api,postman," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://stuartmccoll.github.io"/>

<meta name="twitter:title" content="Creating list items with the Microsoft SharePoint REST API"/>
<meta name="twitter:description" content="In my last blog post I explained how to authenticate requests to Microsoft&rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to store our access token as a Postman environment variable and to then send POST requests to the SharePoint REST API to create new items within an existing SharePoint list.
 If you were following along previously, the last thing we did was to request an access token to use in future requests."/>

<meta property="article:published_time" content="2020-06-18 19:30:00 &#43;0100 BST" />
    </head>

    <body>
        <div class="container">
            <header>
    <section>
        <h1 class="site-heading">Stuart McColl</h1>
        <nav>
            <ul>
                <li><a href="/">Blog</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
    </section>
</header>

<hr />

            <div class="content">
                
<main class="post">

    <article>
        <header>
            <h1 class="post-title">Creating list items with the Microsoft SharePoint REST API</h1>
            <p class="post-date">June 18, 2020</p>
        </header>

        <hr class="post-rule" />

        <div class="post-content">
            <p>In my <a href="../2020-06-16-sharepoint-api-authentication-with-postman">last blog post</a> I explained how to authenticate requests to Microsoft&rsquo;s legacy SharePoint REST API using Postman. This post builds on that work to store our access token as a Postman environment variable and to then send <code>POST</code> requests to the SharePoint REST API to create new items within an existing SharePoint list.</p>
<hr>
<p>If you were following along previously, the last thing we did was to request an access token to use in future requests. We&rsquo;re going to write a couple of lines of JavaScript code within Postman which will parse the API response containing the access token and add it to our previously-created Postman environment.</p>
<p>You should still have a Postman tab open ready to send a request to the following URL:</p>
<pre><code>https://accounts.accesscontrol.windows.net/{{realm}}/tokens/OAuth/2
</code></pre><p>Click on the &lsquo;Tests&rsquo; tab. In the empty window, add the following two lines of code:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">json_response_body</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">responseBody</span><span class="p">);</span>
<span class="nx">postman</span><span class="p">.</span><span class="nx">setEnvironmentVariable</span><span class="p">(</span><span class="s2">&#34;appReg_bearerToken&#34;</span><span class="p">,</span> <span class="nx">json_response_body</span><span class="p">.</span><span class="nx">access_token</span><span class="p">);</span>
</code></pre></div><p>Click &lsquo;Send&rsquo; to send our <code>POST</code> request. You should receive a response body containing an <code>access_token</code> key/value pair. The value of the <code>access_token</code> key will now have been added as the &lsquo;Current Value&rsquo; of our <code>appReg_bearerToken</code> Postman environment variable. You can confirm this by clicking the eye icon next to the environments dropdown and checking the environment variable values.</p>
<p>We&rsquo;re now ready to create a new item within an existing SharePoint list. To do so, we need to know the <code>ListItemEntityTypeFullName</code> of the list. Let&rsquo;s open a new request in Postman, which we&rsquo;re going to send to the following URL (replacing <code>contoso</code> with your tenant name, and &lsquo;Test list&rsquo; with your own list name):</p>
<div class="highlight"><pre class="chroma"><code class="language-http" data-lang="http"><span class="err">GET https://contoso.sharepoint.com/_api/web/lists/GetByTitle(&#39;Test list&#39;)?$select=ListItemEntityTypeFullName
</span><span class="err">Authorization: Bearer {{appReg_bearerToken}}
</span><span class="err">Accept: application/json;odata=nometadata
</span></code></pre></div><p>Before sending, let&rsquo;s add a test to this Postman request which will grab the <code>ListItemEntityTypeFullName</code> value and store it as a Postman environment variable. Click the &lsquo;Tests&rsquo; tab and in the empty window add the following two lines of code:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">json_response_body</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">responseBody</span><span class="p">);</span>
<span class="nx">postman</span><span class="p">.</span><span class="nx">setEnvironmentVariable</span><span class="p">(</span><span class="s2">&#34;ListItemEntityTypeFullName&#34;</span><span class="p">,</span> <span class="nx">json_response_body</span><span class="p">.</span><span class="nx">ListItemEntityTypeFullName</span><span class="p">);</span>
</code></pre></div><p>You should receive a response body which looks something like the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;ListItemEntityTypeFullName&#34;</span><span class="p">:</span> <span class="s2">&#34;SP.Data.Test_x0020_listListItem&#34;</span>
<span class="p">}</span>
</code></pre></div><p>The value of the <code>ListItemEntityTypeFullName</code> key will now have been added as the &lsquo;Current Value&rsquo; of our <code>ListItemEntityTypeFullName</code> Postman environment variable. You can confirm this by clicking the eye icon next to the environments dropdown and checking the environment variable values.</p>
<p>We&rsquo;re now ready to create our test item in our existing SharePoint list. Open a new Postman request, which we&rsquo;ll be sending as a <code>POST</code>. Use the following details, where <code>contoso</code> is replaced with your own tenant name and &lsquo;Test list&rsquo; is replaced with your own SharePoint list name (note the <strong>double</strong> underscore before <code>metadata</code>):</p>
<div class="highlight"><pre class="chroma"><code class="language-http" data-lang="http"><span class="err">POST https://contoso.sharepoint.com/_api/web/lists/GetByTitle(&#39;Test list&#39;)/items
</span><span class="err">Authorization: Bearer {{appReg_bearerToken}}
</span><span class="err">Accept: application/json;odata=verbose
</span><span class="err">Content-Type: application/json;odata=verbose
</span><span class="err">
</span><span class="err">{
</span><span class="err">    &#34;__metadata&#34;: {
</span><span class="err">        &#34;type&#34;: &#34;{{ListItemEntityTypeFullName}}&#34;
</span><span class="err">    },
</span><span class="err">    &#34;Title&#34;: &#34;My test item&#34;
</span><span class="err">}
</span></code></pre></div><p>Send this request and you should receive a <code>201</code> status code in response, as well as a lengthy response body. Check your SharePoint list and you should see that the item has been successfully created.</p>
<p>We can also use the API to retrieve this item. Create a new Postman request and send the following (replacing <code>contoso</code> with your own tenant name, &lsquo;Test list&rsquo; with your own list name and <code>1</code> with the id you will have received in the previous response body after creating your item):</p>
<div class="highlight"><pre class="chroma"><code class="language-http" data-lang="http"><span class="err">GET https://contoso.sharepoint.com/_api/web/lists/GetByTitle(&#39;Test list&#39;)/items(1)
</span><span class="err">Authorization: Bearer {{appReg_bearerToken}}
</span><span class="err">Accept: application/json;odata=verbose
</span></code></pre></div><p>You should receive a <code>200</code> status code in response, as well as a response body containing your chosen SharePoint list item.</p>
<p>In my next blog post I&rsquo;ll look at how we can use the SharePoint REST API to add attachments to our list items.</p>

        </div>
    </article>

</main>

            </div>

            

            <hr />

            <footer>
    
    
    
    <section>
        <h3>Share this content</h3>
        <p>
            <a
                href="https://twitter.com/intent/tweet?url=https://stuartmccoll.github.io%2fposts%2f2020-06-18-creating-list-items-with-sharepoint-rest-api%2f&via=itstuartmccoll&text=I%27m%20reading">
                Tweet this blog post
            </a>
        </p>
    </section>
    <hr />
    
    
    
    <section>
        <h3>More</h3>
        <ul>
            
            <li>
                <a
                    href="https://twitter.com/intent/tweet?text=%40itstuartmccoll%20Hello%2C%20%3Cinsert%20message%20here%3E">
                    Contact me on Twitter
                </a>
            </li>
            
            
            <li>Spotted a bug in the site?
                <a href="https://github.com/stuartmccoll/hugo-theme-refresh/issues/new">
                    Raise an issue on GitHub
                </a>
            </li>
            
            <li>Get notifications of new posts by
                <a href="https://stuartmccoll.github.io/index.xml">
                    subscribing to my RSS feed
                </a>
            </li>
            
            <li>This static site was generated using
                <a href="https://github.com/gohugoio/hugo/releases/tag/v0.70.0">
                    Hugo version 0.70.0
                </a>
            </li>
            
        </ul>
    </section>
    <hr />
    
    <section>
        <h3>Attribution</h3>
        <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
            
            This blog post <span rel="dct:title">(Creating list items with the Microsoft SharePoint REST API)</span> is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a>. Any code contained within
            this article may be subject to other licenses.
            
        </p>
    </section>
    
</footer>

            
        </div>
    </body>

</html>