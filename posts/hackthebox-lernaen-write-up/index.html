<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Stuart McColl ">
<meta name="description"
    content="HackTheBox is an online platform for testing and advancing skills in penetration testing and cyber security. The site provides vulnerable machines as well as dedicated challenges in areas such as forensics, cryptography and web applications. The following is a write-up after completion of HackTheBox&amp;rsquo;s Lernaen web challenge.
Our instance of the challenge will be contained in a Docker container - after starting the instance you&amp;rsquo;ll be given an address, such as docker." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/hackthebox-lernaen-write-up/" />


<title>
    
    HackTheBox Lernaen Write-Up :: Stuart McColl  â€” Software Design and Development
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.91687bbfc139d7ff1a244bb6d7324425f9c4f424eaaad242b478e3b3cf56396a.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627">
<meta itemprop="name" content="HackTheBox Lernaen Write-Up">
<meta itemprop="description" content="HackTheBox Lernaen Write-Up">


<meta itemprop="datePublished" content="2019-02-03T10:10:32&#43;00:00" />
<meta itemprop="dateModified" content="2019-02-03T10:10:32&#43;00:00" />
<meta itemprop="wordCount" content="614">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="HackTheBox Lernaen Write-Up"/>
<meta name="twitter:description" content="HackTheBox Lernaen Write-Up"/>




<meta property="article:published_time" content="2019-02-03 10:10:32 &#43;0000 GMT" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">cd ~/</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">about</a></li><li><a href="/posts">blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/posts/hackthebox-lernaen-write-up/">HackTheBox Lernaen Write-Up</a></h2>

            

            <div class="post-content">
                <p>HackTheBox is an online platform for testing and advancing skills in penetration testing and cyber security. The site provides vulnerable machines as well as dedicated challenges in areas such as forensics, cryptography and web applications. The following is a write-up after completion of HackTheBox&rsquo;s Lernaen web challenge.</p>

<p>Our instance of the challenge will be contained in a Docker container - after starting the instance you&rsquo;ll be given an address, such as docker.hackthebox.eu, and a port number. Combine the two (in <code>address:port</code> format), and navigate to the full address in a web browser, where we&rsquo;ll see the following:</p>

<p><img src="../assets/htb-lernaen-01.png" alt="Screenshot of the login page for the HackTheBox Lernaen challenge" /></p>

<p>Looking at the source code, there&rsquo;s nothing obviously untoward that we can use to enable us to bypass the login functionality. Attempting some SQL injection, or guessing with common passwords simply dump us back on the same page with an &lsquo;Invalid password!&rsquo; message. So, we&rsquo;ll take the hint and brute force our way in.</p>

<p>If we search the internet for &lsquo;Lernaean&rsquo; then the results reveal that the Lernaen Hydra is a monster in Greek and Roman mythology. This is another huge hint - <a href="https://tools.kali.org/password-attacks/hydra">THC Hydra</a> is a tool used to perform rapid dictionary attacks against a number of protocols, HTTP being one of them. Revisiting the source code again, we can see that the password is being sent to the server by way of a <code>POST</code> form. With this information, and the previously-returned &lsquo;Invalid password!&rsquo; message, combined with a reliable word list, we can use Hydra to brute force our way in.</p>

<p><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt.gz docker.hackthebox.eu http-post-form &quot;/:password=^PASS^:Invalid password!&quot; -s 99999</code></p>

<p>Breaking down the above command, let&rsquo;s take a look at what we&rsquo;re actually doing:</p>

<ul>
<li><code>-l admin</code> - this is the username that we&rsquo;re attempting to login with. As it isn&rsquo;t being provided, we&rsquo;re taking a guess that it&rsquo;ll be a default, such as admin.</li>
<li><code>-P /usr/share/wordlists/rockyou.txt.gz</code> - this is the name/location of the password file, or word list, that we&rsquo;re going to be using. I&rsquo;m running Kali Linux, which provides the reliable RockYou wordlist out of the box.</li>
<li><code>docker.hackthebox.eu</code> - this is the address of the server that we&rsquo;re going to be running our attack against.</li>
<li><code>http-post-form</code> - this is the type of request that we&rsquo;re going to be making, which we discovered in our earlier viewing of the source code.</li>
<li><code>&quot;/:password=^PASS^:Invalid password!&quot;</code> - let&rsquo;s take a look at each instance of this in turn; <code>/</code> specifies the directory where the login page exists, which is the root directory for us; <code>:password=^PASS^</code> is where we assign the element on the page to the <code>PASS</code> variable; <code>:Invalid password!</code> is the message returned when our password has failed.</li>
<li><code>-s 99999</code> - finally, this is the port on the server that we&rsquo;re going to be running our attack against.</li>
</ul>

<p>After running the command, Hydra will deliver the password which allowed for successful login - <code>leonardo</code>. Now we&rsquo;ve found the password, let&rsquo;s login and hopefully capture our flag.</p>

<p><img src="../assets/htb-lernaen-02.png" alt="Screenshot of the successful login page for the HackTheBox Lernaen challenge" /></p>

<p>Almost there, but not quite. The message &lsquo;Too slow&rsquo; makes it sound like there&rsquo;s something going on here that we&rsquo;ll need to intercept - perhaps a redirect. We could attempt to intercept this with a tool like BurpSuite, or, remaining in a terminal,  we could quickly spin up a Python interpreter and use the <a href="https://pypi.org/project/requests/">requests</a> module to make our <code>POST</code> request without following the redirect which we believe to be in place.</p>

<pre><code class="language-python">&gt;&gt;&gt; response = requests.post('http://docker.hackthebox.eu:99999', data={'password': 'leonardo'}, allow_redirects=False)
&gt;&gt;&gt; response.content
b'&lt;h1 style=\'color: #fff;\'&gt;HTB{l1k3_4_b0s5_s0n}&lt;/h1&gt;&lt;script type=&quot;text/javascript&quot;&gt;\n                   window.location = &quot;noooooooope.html&quot;\n              &lt;/script&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Login - Lernaean&lt;/title&gt;\n&lt;/head&gt;\n&lt;body style=&quot;background-color: #cd4e7b;&quot;&gt;\n    &lt;center&gt;\n        &lt;br&gt;&lt;br&gt;&lt;br&gt;\n        &lt;h1&gt;&lt;u&gt;Administrator Login&lt;/u&gt;&lt;/h1&gt;\n        &lt;h2&gt;--- CONFIDENTIAL ---&lt;/h2&gt;\n        &lt;h2&gt;Please do not try to guess my password!&lt;/h2&gt;\n        &lt;form method=&quot;POST&quot;&gt;\n            &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;&lt;br&gt;\n            &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;\n        &lt;/form&gt;\n    &lt;/center&gt;\n&lt;/body&gt;\n&lt;/html&gt;'
</code></pre>

<p>Look inside the first <code>h1</code> element and you&rsquo;ll find our flag.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="/">Stuart McColl</a></span>
            
            <span></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.cf7871ed49474a80ed457154d24e61f7881adbe0f9384951a74ac46b688a39a4dbfa68bc6d37baeb058186de354ead3487d4ee7f083ea4cba860c48600b694f3.js" integrity="sha512-z3hx7UlHSoDtRXFU0k5h94ga2&#43;D5OElRp0rEa2iKOaTb&#43;mi8bTe66wWBht41Tq00h9Tufwg&#43;pMuoYMSGALaU8w=="></script>



    </body>
</html>
